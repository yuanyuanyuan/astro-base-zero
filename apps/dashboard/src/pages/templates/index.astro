---
// æ¨¡æ¿å¸‚åœºé¡µ - é™æ€ç‰ˆæœ¬ï¼Œå…¼å®¹ GitHub Pages
import DashboardLayout from '../../layouts/DashboardLayout.astro';

// é™æ€æ¨¡æ¿æ•°æ®
const templates = [
  {
    id: 'base',
    name: 'åŸºç¡€æ¨¡æ¿',
    description: 'æœ€ç®€æ´çš„èµ·å§‹æ¨¡æ¿ï¼ŒåŒ…å«åŸºç¡€çš„å¸ƒå±€å’Œç»„ä»¶ç»“æ„',
    category: 'é€šç”¨',
    icon: 'âš¡',
    features: [
      'ğŸ¨ ç°ä»£åŒ–è®¾è®¡',
      'ğŸ“± å“åº”å¼å¸ƒå±€',
      'ğŸ”§ å¼€ç®±å³ç”¨',
      'ğŸš€ æ€§èƒ½ä¼˜åŒ–'
    ],
    useCases: ['æ¼”ç¤ºé¡¹ç›®', 'å¿«é€ŸåŸå‹', 'å­¦ä¹ ç»ƒä¹ '],
    command: 'astro-zero create my-project --template base',
    demoUrl: '#',
    sourceUrl: 'https://github.com/astro-base-zero/astro-base-zero/tree/main/packages/templates/base'
  },
  {
    id: 'blog',
    name: 'åšå®¢æ¨¡æ¿',
    description: 'é€‚åˆåšå®¢å†™ä½œï¼Œæ”¯æŒ Markdownã€æ ‡ç­¾åˆ†ç±»å’Œæ–‡ç« ç®¡ç†',
    category: 'å†…å®¹åˆ›ä½œ',
    icon: 'ğŸ“',
    features: [
      'ğŸ“„ Markdown æ”¯æŒ',
      'ğŸ·ï¸ æ ‡ç­¾åˆ†ç±»',
      'ğŸ” å…¨æ–‡æœç´¢',
      'ğŸ“Š é˜…è¯»ç»Ÿè®¡'
    ],
    useCases: ['ä¸ªäººåšå®¢', 'æŠ€æœ¯æ–‡æ¡£', 'çŸ¥è¯†åˆ†äº«'],
    command: 'astro-zero create my-blog --template blog',
    demoUrl: '#',
    sourceUrl: 'https://github.com/astro-base-zero/astro-base-zero/tree/main/packages/templates/blog'
  },
  {
    id: 'tool',
    name: 'å·¥å…·æ¨¡æ¿',
    description: 'é€‚åˆå±•ç¤ºåœ¨çº¿å·¥å…·ï¼ŒåŒ…å«äº¤äº’æ¼”ç¤ºå’Œä½¿ç”¨è¯´æ˜',
    category: 'å·¥å…·å±•ç¤º',
    icon: 'ğŸ”§',
    features: [
      'âš¡ React ç»„ä»¶',
      'ğŸ¯ äº¤äº’æ¼”ç¤º',
      'ğŸ“– ä½¿ç”¨è¯´æ˜',
      'ğŸ“Š æ•°æ®å¤„ç†'
    ],
    useCases: ['åœ¨çº¿å·¥å…·', 'è®¡ç®—å™¨', 'è½¬æ¢å™¨'],
    command: 'astro-zero create my-tool --template tool',
    demoUrl: '#',
    sourceUrl: 'https://github.com/astro-base-zero/astro-base-zero/tree/main/packages/templates/tool'
  }
];

const categories = [...new Set(templates.map(t => t.category))];
---

<DashboardLayout title="æ¨¡æ¿å¸‚åœº" description="æµè§ˆå’Œä¸‹è½½ Astro é¡¹ç›®æ¨¡æ¿">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <div class="mb-8">
    <div class="flex items-center justify-between">
      <div>
        <h1 class="text-3xl font-bold text-secondary-900">æ¨¡æ¿å¸‚åœº</h1>
        <p class="mt-2 text-lg text-secondary-600">
          é€‰æ‹©é€‚åˆä½ çš„é¡¹ç›®æ¨¡æ¿ï¼Œå¿«é€Ÿå¼€å§‹å¼€å‘
        </p>
      </div>
      
      <div class="flex items-center space-x-3">
        <button 
          onclick="showCliGuide()"
          class="bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-md font-medium transition-colors"
        >
          CLI ä½¿ç”¨æŒ‡å—
        </button>
      </div>
    </div>
  </div>

  <!-- CLI ä½¿ç”¨æŒ‡å—é¢æ¿ -->
  <div id="cli-guide" class="hidden mb-8 bg-blue-50 border border-blue-200 rounded-lg p-6">
    <div class="flex items-start justify-between">
      <div class="flex-1">
        <h3 class="text-lg font-semibold text-blue-900 mb-4">ğŸ“‹ å¦‚ä½•ä½¿ç”¨æ¨¡æ¿</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <h4 class="font-medium text-blue-800 mb-2">æ–¹æ³•ä¸€ï¼šä½¿ç”¨ CLI å·¥å…·ï¼ˆæ¨èï¼‰</h4>
            <div class="space-y-2">
              <div class="bg-blue-900 text-blue-100 p-3 rounded-md font-mono text-sm">
                <code># å®‰è£… CLI å·¥å…·</code><br>
                <code>npm install -g @astro-base-zero/cli</code>
              </div>
              <div class="bg-blue-900 text-blue-100 p-3 rounded-md font-mono text-sm">
                <code># ä½¿ç”¨æ¨¡æ¿åˆ›å»ºé¡¹ç›®</code><br>
                <code>astro-zero create my-project --template blog</code>
              </div>
            </div>
          </div>
          
          <div>
            <h4 class="font-medium text-blue-800 mb-2">æ–¹æ³•äºŒï¼šç›´æ¥ä¸‹è½½æ¨¡æ¿</h4>
            <div class="space-y-2">
              <div class="bg-blue-900 text-blue-100 p-3 rounded-md font-mono text-sm">
                <code># å…‹éš†ä»“åº“</code><br>
                <code>git clone https://github.com/astro-base-zero/astro-base-zero.git</code>
              </div>
              <div class="bg-blue-900 text-blue-100 p-3 rounded-md font-mono text-sm">
                <code># å¤åˆ¶æ¨¡æ¿åˆ°æ–°ç›®å½•</code><br>
                <code>cp -r packages/templates/blog my-project</code>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <button 
        onclick="hideCliGuide()"
        class="text-blue-400 hover:text-blue-600 transition-colors ml-4"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>
  </div>

  <!-- åˆ†ç±»è¿‡æ»¤å™¨ -->
  <div class="mb-6">
    <div class="flex flex-wrap gap-2">
      <button 
        onclick="filterTemplates('all')"
        class="filter-btn active px-4 py-2 text-sm font-medium bg-primary-600 text-white rounded-md transition-colors"
        data-category="all"
      >
        å…¨éƒ¨æ¨¡æ¿
      </button>
      {categories.map(category => (
        <button 
          onclick={`filterTemplates('${category}')`}
          class="filter-btn px-4 py-2 text-sm font-medium bg-secondary-100 text-secondary-700 hover:bg-secondary-200 rounded-md transition-colors"
          data-category={category}
        >
          {category}
        </button>
      ))}
    </div>
  </div>

  <!-- æ¨¡æ¿ç½‘æ ¼ -->
  <div id="templates-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    {templates.map(template => (
      <div 
        class="template-card bg-white rounded-lg border border-secondary-200 hover:border-primary-300 hover:shadow-lg transition-all duration-200"
        data-category={template.category}
      >
        <!-- æ¨¡æ¿å¤´éƒ¨ -->
        <div class="p-6">
          <div class="flex items-start justify-between mb-4">
            <div class="flex items-center space-x-3">
              <span class="text-3xl">{template.icon}</span>
              <div>
                <h3 class="text-lg font-semibold text-secondary-900">{template.name}</h3>
                <span class="text-sm text-secondary-500">{template.category}</span>
              </div>
            </div>
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 text-primary-800">
              æ¨è
            </span>
          </div>

          <p class="text-secondary-600 mb-4 line-clamp-2">
            {template.description}
          </p>

          <!-- ç‰¹æ€§æ ‡ç­¾ -->
          <div class="flex flex-wrap gap-2 mb-4">
            {template.features.slice(0, 3).map(feature => (
              <span class="inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-secondary-100 text-secondary-700">
                {feature}
              </span>
            ))}
          </div>

          <!-- ä½¿ç”¨åœºæ™¯ -->
          <div class="mb-4">
            <h4 class="text-sm font-medium text-secondary-700 mb-2">é€‚ç”¨åœºæ™¯:</h4>
            <div class="flex flex-wrap gap-1">
              {template.useCases.map(useCase => (
                <span class="inline-flex items-center px-2 py-1 rounded-md text-xs bg-green-100 text-green-700">
                  {useCase}
                </span>
              ))}
            </div>
          </div>

          <!-- CLI å‘½ä»¤ -->
          <div class="mb-4">
            <h4 class="text-sm font-medium text-secondary-700 mb-2">åˆ›å»ºå‘½ä»¤:</h4>
            <div class="bg-secondary-900 text-green-400 p-3 rounded-md font-mono text-sm relative">
              <code>{template.command}</code>
              <button 
                onclick={`copyCommand('${template.command}')`}
                class="absolute top-2 right-2 text-secondary-400 hover:text-green-400 transition-colors"
                title="å¤åˆ¶å‘½ä»¤"
              >
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                </svg>
              </button>
            </div>
          </div>
        </div>

        <!-- æ¨¡æ¿æ“ä½œ -->
        <div class="px-6 pb-6">
          <div class="flex space-x-3">
            <a 
              href={template.sourceUrl}
              target="_blank"
              class="flex-1 bg-primary-600 hover:bg-primary-700 text-white text-center py-2 px-4 rounded-md text-sm font-medium transition-colors"
            >
              æŸ¥çœ‹æºç 
            </a>
            <button 
              onclick={`showTemplateDetails('${template.id}')`}
              class="flex-1 bg-secondary-100 hover:bg-secondary-200 text-secondary-700 py-2 px-4 rounded-md text-sm font-medium transition-colors"
            >
              æŸ¥çœ‹è¯¦æƒ…
            </button>
          </div>
        </div>
      </div>
    ))}
  </div>

  <!-- æ¨¡æ¿è¯¦æƒ…æ¨¡æ€æ¡† -->
  <div id="template-details-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center">
    <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
      <div class="flex items-center justify-between p-6 border-b border-secondary-200">
        <h2 class="text-xl font-semibold text-secondary-900" id="modal-title">æ¨¡æ¿è¯¦æƒ…</h2>
        <button 
          onclick="closeTemplateDetails()"
          class="text-secondary-400 hover:text-secondary-600 transition-colors"
        >
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
      
      <div class="p-6" id="modal-content">
        <!-- åŠ¨æ€å†…å®¹å°†åœ¨è¿™é‡Œæ’å…¥ -->
      </div>
    </div>
  </div>

  <!-- åº•éƒ¨è¯´æ˜ -->
  <div class="mt-12 bg-secondary-50 rounded-lg p-6">
    <h3 class="text-lg font-semibold text-secondary-900 mb-4">ğŸ’¡ ä½¿ç”¨æç¤º</h3>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <h4 class="font-medium text-secondary-800 mb-2">è‡ªå®šä¹‰æ¨¡æ¿</h4>
        <p class="text-sm text-secondary-600">
          ä½ å¯ä»¥åŸºäºç°æœ‰æ¨¡æ¿åˆ›å»ºè‡ªå·±çš„è‡ªå®šä¹‰æ¨¡æ¿ã€‚ä¿®æ”¹æ¨¡æ¿æ–‡ä»¶åï¼Œå¯ä»¥åœ¨æœ¬åœ°é¡¹ç›®ä¸­å¤ç”¨ã€‚
        </p>
      </div>
      <div>
        <h4 class="font-medium text-secondary-800 mb-2">å“ç‰Œå®šåˆ¶</h4>
        <p class="text-sm text-secondary-600">
          æ‰€æœ‰æ¨¡æ¿éƒ½æ”¯æŒå“ç‰Œä¿¡æ¯è‡ªåŠ¨æ³¨å…¥ã€‚ä½¿ç”¨ <code class="bg-secondary-200 px-1 rounded">astro-zero config brand</code> è®¾ç½®ä½ çš„å“ç‰Œä¿¡æ¯ã€‚
        </p>
      </div>
    </div>
  </div>
</DashboardLayout>

<script define:vars={{ templates }} is:inline>
  // æ¨¡æ¿å¸‚åœºäº¤äº’è„šæœ¬
  document.addEventListener('DOMContentLoaded', function() {
    // æ˜¾ç¤º/éšè— CLI æŒ‡å—
    window.showCliGuide = function() {
      document.getElementById('cli-guide')?.classList.remove('hidden');
    };

    window.hideCliGuide = function() {
      document.getElementById('cli-guide')?.classList.add('hidden');
    };

    // è¿‡æ»¤æ¨¡æ¿
    window.filterTemplates = function(category) {
      const cards = document.querySelectorAll('.template-card');
      const buttons = document.querySelectorAll('.filter-btn');

      // æ›´æ–°æŒ‰é’®çŠ¶æ€
      buttons.forEach(btn => {
        btn.classList.remove('active', 'bg-primary-600', 'text-white');
        btn.classList.add('bg-secondary-100', 'text-secondary-700');
      });

      const activeBtn = document.querySelector(`[data-category="${category}"]`);
      if (activeBtn) {
        activeBtn.classList.add('active', 'bg-primary-600', 'text-white');
        activeBtn.classList.remove('bg-secondary-100', 'text-secondary-700');
      }

      // è¿‡æ»¤æ¨¡æ¿å¡ç‰‡
      cards.forEach(card => {
        const cardCategory = card.getAttribute('data-category');
        if (category === 'all' || cardCategory === category) {
          card.style.display = 'block';
        } else {
          card.style.display = 'none';
        }
      });
    };

    // å¤åˆ¶å‘½ä»¤
    window.copyCommand = async function(command) {
      try {
        await navigator.clipboard.writeText(command);
        
        const notification = document.createElement('div');
        notification.className = 'fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50';
        notification.textContent = 'å‘½ä»¤å·²å¤åˆ¶åˆ°å‰ªè´´æ¿';
        document.body.appendChild(notification);
        
        setTimeout(() => {
          document.body.removeChild(notification);
        }, 2000);
      } catch (err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);
      }
    };

    // æ˜¾ç¤ºæ¨¡æ¿è¯¦æƒ…
    window.showTemplateDetails = function(templateId) {
      const template = templates.find(t => t.id === templateId);
      if (!template) return;

      const modal = document.getElementById('template-details-modal');
      const title = document.getElementById('modal-title');
      const content = document.getElementById('modal-content');

      if (title) title.textContent = template.name + ' - è¯¦ç»†ä¿¡æ¯';
      
      if (content) {
        content.innerHTML = `
          <div class="space-y-6">
            <div>
              <h3 class="text-lg font-medium text-secondary-900 mb-3">æ¨¡æ¿æè¿°</h3>
              <p class="text-secondary-600">${template.description}</p>
            </div>

            <div>
              <h3 class="text-lg font-medium text-secondary-900 mb-3">å®Œæ•´ç‰¹æ€§åˆ—è¡¨</h3>
              <div class="grid grid-cols-2 gap-2">
                ${template.features.map(feature => 
                  `<div class="flex items-center text-sm text-secondary-700">
                    <span class="mr-2">âœ“</span>${feature}
                  </div>`
                ).join('')}
              </div>
            </div>

            <div>
              <h3 class="text-lg font-medium text-secondary-900 mb-3">ä½¿ç”¨åœºæ™¯</h3>
              <div class="flex flex-wrap gap-2">
                ${template.useCases.map(useCase => 
                  `<span class="inline-flex items-center px-3 py-1 rounded-full text-sm bg-green-100 text-green-800">
                    ${useCase}
                  </span>`
                ).join('')}
              </div>
            </div>

            <div>
              <h3 class="text-lg font-medium text-secondary-900 mb-3">åˆ›å»ºå‘½ä»¤</h3>
              <div class="bg-secondary-900 text-green-400 p-4 rounded-md font-mono text-sm">
                ${template.command}
              </div>
            </div>

            <div class="flex space-x-3">
              <a 
                href="${template.sourceUrl}" 
                target="_blank"
                class="flex-1 bg-primary-600 hover:bg-primary-700 text-white text-center py-3 px-4 rounded-md font-medium transition-colors"
              >
                æŸ¥çœ‹ GitHub æºç 
              </a>
              <button 
                onclick="copyCommand('${template.command}')"
                class="flex-1 bg-secondary-100 hover:bg-secondary-200 text-secondary-700 py-3 px-4 rounded-md font-medium transition-colors"
              >
                å¤åˆ¶åˆ›å»ºå‘½ä»¤
              </button>
            </div>
          </div>
        `;
      }

      modal?.classList.remove('hidden');
      modal?.classList.add('flex');
    };

    // å…³é—­æ¨¡æ¿è¯¦æƒ…
    window.closeTemplateDetails = function() {
      const modal = document.getElementById('template-details-modal');
      modal?.classList.add('hidden');
      modal?.classList.remove('flex');
    };
  });
</script>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  .filter-btn.active {
    @apply bg-primary-600 text-white;
  }
</style> 